(()=>{function u(t,n){var e=localStorage.getItem("userId");this.score=t,this.body=n;var i=fetch("/score",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({score:this.score,usrId:e})}).then(r=>{console.log("status ",r.status),r.status===200?console.log("score inserted :)"):console.log("failed inserting .-.")}).catch(r=>{console.error("Error:",r)});this.getScore()}u.prototype.m_construct=function(){};u.prototype.getScore=function(){var t=this,n=fetch("/getscore",{method:"post",headers:{"Content-Type":"application/json"}}).then(e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()}).then(e=>{t.handelInfo(e)}).catch(e=>{console.error("There was a problem with the fetch operation:",e)})};u.prototype.handelInfo=function(t){for(var n=this.body,e=0;e<t.length;e++){var i=t[e].user_full_name,r=t[e].points,o=new Date(t[e].date);let h=o.getFullYear(),m=String(o.getMonth()+1).padStart(2,"0"),l=String(o.getDate()).padStart(2,"0"),v=String(o.getHours()).padStart(2,"0"),f=String(o.getMinutes()).padStart(2,"0"),w=`${h}-${m}-${l} ${v}:${f}`;var s=document.createElement("div"),c=document.createTextNode(i+" / "+r+" / "+w);s.appendChild(c),n.appendChild(s);var a=document.createElement("hr");n.appendChild(a)}};function d(){this.active=!1,this.score=0,this.time=60,this.body=document.body,this.bd=document.getElementById("body"),this.swipeStart=0,this.swipeEnd=0,this.CountSwipes=0,this.m_construct()}d.prototype.m_construct=function(){this.buildOneRound(),this.countDownOnemin()};d.prototype.buildOneRound=async function(){var t=this,n=new URLSearchParams(window.location.search),e=n.get("pram"),i=Number(e),r=await c(),o=0,s=0;this.wordsArr=JSON.parse(r);async function c(){var a=await fetch("/getArr",{method:"post",headers:{"content-Type":"application/json"},body:JSON.stringify({id:i})}),h=await a.json();return h}this.oneWord=0,this.bd.innerHTML="",this.minDiv=document.createElement("div"),this.minDiv.style.marginBottom="25px",this.minDiv.setAttribute("id","min"),this.minDiv.innerHTML=this.time,this.bd.appendChild(this.minDiv),this.wordDiv=document.createElement("div"),this.wordDiv.setAttribute("id","word"),this.bd.appendChild(this.wordDiv),this.wordDiv.innerHTML=this.wordsArr[this.oneWord],this.active=!0,this.body.addEventListener("touchstart",function(a){t.active==!0&&(o=a.changedTouches[0].pageY)}),this.body.addEventListener("touchend",function(a){t.active==!0&&(t.CountSwipes++,s=a.changedTouches[0].pageY,t.handleSwipe(s,o))})};d.prototype.handleSwipe=function(t,n){var e=this;t<n&&(++this.score,this.changeClass("red","green")),t>n&&this.changeClass("green","red")};d.prototype.changeClass=function(t,n){var e=this;this.body.classList.remove(t),this.body.classList.add(n),setTimeout(function(){e.body.classList.remove(t,n)},500),this.oneWord<4&&(++this.oneWord,this.wordDiv.innerHTML=this.wordsArr[this.oneWord])};d.prototype.countDownOnemin=function(){var t=this,n=function(){t.time--,t.minDiv.innerHTML=t.time,(t.score==5||t.time==0||t.CountSwipes==5)&&(clearInterval(e),t.gameOver())},e=setInterval(n,1e3)};d.prototype.gameOver=function(){var t=this;this.active=!1,this.bd.innerHTML="";var n=new u(this.score,this.bd)};function p(t){this.body=document.body,this.secs=t,this.address()}window.addEventListener("load",function(){var t=this.localStorage.getItem("userId");if(t)var n=new p(3);else this.location.assign("login.html")});p.prototype.m_construct=function(){};p.prototype.address=function(){var t=this,n=document.createElement("button"),e=document.createTextNode("Share This Round");n.appendChild(e),this.body.appendChild(n);var i=document.createElement("button"),r=document.createTextNode("Start This Round");i.appendChild(r),this.body.appendChild(i),n.addEventListener("click",function(o){var s=new URLSearchParams(window.location.search),c=s.get("pram");navigator.permissions.query({name:"clipboard-write"}).then(a=>{if(a.state==="granted"||a.state==="prompt"){var h=window.location.origin+"/shared.html?pram="+c;navigator.clipboard.writeText(h)}})}),i.addEventListener("click",function(){var o=document.createElement("div");o.setAttribute("id","secs"),t.body.appendChild(o),o.innerHTML=t.secs;var s=new Audio("countdown.mp3");s.play(),t.countDownSec(t.secs,o)})};p.prototype.countDownSec=function(t,n){var e=document.querySelectorAll("button");e.forEach(function(o){o.remove()});var i=function(){var o=new Audio("sec.mp3");if(o.play(),--t,n.innerHTML=t,t===-1){n.innerHTML="",clearInterval(r);var s=new d}},r=setInterval(i,1e3)};})();
//# sourceMappingURL=CountDown.js.map
